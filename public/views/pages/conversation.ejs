<a-entity position="1 0 0" rotation="0 -90 0">
  <a-entity id="conversation_wall" >
    <% var i = 0; if (conversations) { %>
      <% conversations.forEach (function (conversation){ i+=1 %> 
        <a-entity kotak-conversation 
          conversation_id="<%= conversation.id %>" 
          class="clickable"
          spawn-chat-button
          nama_penerima="
          <%if (conversation.user1.id == user_id){%>
            <%=conversation.user2.name%> 
          <% } else {%>
            <%=conversation.user1.name%> 
          <%}  %> 
          "
          id="<%=conversation.id%>-conversation" 
          material="color:green"
          geometry="primitive: plane;height:0.2; width:2;" 
          position="0 <%=i*0.3 %> -2" color="#4CC3D9" 
          text="color:white; align: center; value:
            <%if (conversation.user1.id == user_id){%>
              <%=conversation.user2.name%> 
            <% } else {%>
              <%=conversation.user1.name%> 
            <%}  %> 
          " >
        </a-entity>
      <% }) } %>
  </a-entity>
  <a-entity class="clickable" id="title" text-geometry="value: Conversation"position="-1 2 -3"></a-entity>
  <a-sky color="black"></a-sky>
  <a-entity id="search_conversation" position="2 2 -1.9">
    <a-box class="clickable" search-user-button  color="yellow" position="1 0 -0.7"> </a-box>
    <a-entity id="conversation-searchuser" textarea="backgroundColor: blue; color: white" class="clickable" geometry="primitive:plane;" material="color: blue"></a-entity>
    <a-text class="clickable" text="value: Search" position="0.7 0 -0.2"></a-text>
  </a-entity>
</a-entity>

<script>
  // spawnChat(15)
  const user_id = "<%=user_id%>"
  console.log('<%=conversations%>')
  function refreshSearch(result) {
      var text = ''
      var i = 1
      $('#conversation_wall').empty()
      if(result.length>0){
        result.forEach (function (result){
          if(result.id != user_id)
          $('#conversation_wall').append(
            `<a-entity position="0 ${i*0.3} -1">`+
              `<a-box id="${result.id}-result" user_id="${result.id}" class="clickable" add-user-button width="1" height="0.2" depth="0.2"></a-box>` +
              ` <a-text text="value: ${result.name}; align:center " position="0 0 0.1" color="black"></a-text>` +
            `</a-entity>`
            )
          i+=1
        })
      }
      else {
        $('#conversation_wall').append('<a-text text="value: Not Found!" ></a-text>')
      }
  }
</script>